#:import SPlayScreen sharePlay.splay.SPlayScreen
#:import MainScreen screens.mainscreen.MainScreen

<MainScreen>:
    id: main_screen
    BoxLayout:
        orientation: "vertical"

        MDToolbar:
            id: main_toolbar
            title: "Matrix Music Player"
            # right_action_items: [["settings", lambda x: root.go_to_settings()]]

            MDIconButton:
                id: settings_btn
                icon: 'settings'
                on_release: root.go_to_settings()

        MDBottomNavigation:

            HomeScreen:
                name: "home_screen"
                text: 'Home'
                icon: 'home'

            SongListScreen:
                name: "song_list_screen"
                text: 'Songs'
                icon: 'music'

            SPlayScreen:
                name: "splay_screen"
                text: 'SPLAY'


<ItemWithRemove>:

    IconRightWidget:
        icon: 'minus'

<SettingsSearchPathsScreen>:
    name: 'settings_search_paths'
    BoxLayout:
        orientation: 'vertical'

        ScrollView:

            MDList:
                id: search_paths_list

        MDBottomAppBar:
            MDToolbar:
                title: "Search Paths"
                icon: "plus"
                type: 'bottom'
                left_action_items: [["arrow-left", lambda x: root.go_to_settings()]]
                on_action_button: root.launch_file_manager()
                mode: 'end'

<SettingsNowPlayingScreen>:
    name: 'now_playing_settings'
    BoxLayout:
        orientation: 'vertical'

        ScrollView:

            MDList:
                TwoLineIconListItem:
                    text: "Background"
                    secondary_text: "background of the now playing screen"
                    on_press: root.open_background_selector()

                    IconLeftWidget:
                        icon: 'format-color-fill'

<SettingsThemeScreen>:
    id: theme_settings
    name: 'theme_settings'
    BoxLayout:
        orientation: 'vertical'

        ScrollView:
            MDList:
                TwoLineIconListItem:
                    text: "Colors"
                    secondary_text: "theme, accent, style"
                    on_press: root.open_theme_picker()

                    IconLeftWidget:
                        icon: 'format-color-fill'


<SettingsScreen>:
    id: settings_screen
    BoxLayout:
        orientation: 'vertical'

        MDToolbar:
            title: "Settings"
            left_action_items: [["arrow-left", lambda x: root.go_to_main()]]

        ScrollView:

            MDList:
                id: settings_list

                TwoLineIconListItem:
                    text: "Search Paths"
                    secondary_text: "where to look for songs"
                    on_press: root.go_to_search_paths()

                    IconLeftWidget:
                        icon: 'folder-search'

                TwoLineIconListItem:
                    text: "App Theme"
                    secondary_text: "change the looks of the app"
                    on_press: root.go_to_themes()

                    IconLeftWidget:
                        icon: 'format-color-fill'

                TwoLineIconListItem:
                    text: "Now Playing"
                    secondary_text: "change the looks of the now-playing screen"
                    on_press: root.go_to_now_playing()

                    IconLeftWidget:
                        icon: 'play-circle-outline'




<HomeScreen>:
    AnchorLayout:
        MDLabel:
            text: "WILL BE POPULATED SOON"
            theme_text_color: "Hint"
            font_style: "Button"
            halign: 'center'
            position: {'center_x': 0.5, 'center_y': '0.5'}

        # MDFlatButton:
        #     text: "LOAD AD"
        #     on_release: root._load_ad()

<SongListScreen>:
    BoxLayout:
        orientation: "vertical"

        ScrollView:
            MDList:
                id: songs_list

<SongItem>:
    ImageLeftWidget:
        id: artwork_thumb
        allow_stretch: True
        keep_ratio: False
        size_hint: 1, 1

<SongScreen>:
    name: 'song_screen'
    BoxLayout:
        orientation: 'vertical'
        id: song_screen_bg
        spacing: dp(10)

        BoxLayout:
            size_hint_y: 0.05

        MDCard:
            size_hint: 0.95, 0.5
            pos_hint: {"center_x": .5, "center_y": .5}
            # canvas:
            #     Color:
            #         rgba: (0, 0, 0, 0)
            #     Rectangle:
            #         size: self.size
            #         pos: self.pos

            FitImage:
                size_hint: 1, 1
                id: album_art

        BoxLayout:
            orientation: 'vertical'
            size_hint_y: 0.5
            # canvas.before:
            #     Color:
            #         rgba: (0, 0, 1, 0.5)
            #     Rectangle:
            #         size: self.size
            #         pos: self.pos

            MDLabel:
                text: root.song_name
                halign: 'center'
                theme_text_color: 'Primary'

            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: 0.05

                MDLabel:
                    id: song_cur_pos_label
                    size_hint: 0.2, 1
                    halign: "center"
                    theme_text_color: 'Primary'
                MDSlider:
                    id: song_slider
                    min: 0
                    max: root.song_max_length
                    value: root.song_current_pos
                    hint: False
                    on_touch_up: if self.collide_point(*args[1].pos): root.seek_song()
                MDLabel:
                    id: song_total_length_label
                    size_hint: 0.2, 1
                    halign: "center"
                    theme_text_color: 'Primary'

            BoxLayout:
                MDBottomAppBar:
                    MDToolbar:
                        id: song_screen_toolbar
                        icon: root.song_state
                        type: 'bottom'
                        left_action_items: [["repeat-off" if root.loop_status == 0 else "repeat-once", lambda x: root.toggle_loop()], ["skip-previous", lambda x: root.prev_song()]]
                        right_action_items: [["skip-next", lambda x: root.next_song()], ["shuffle-disabled" if not root.shuffle_status else "shuffle-variant", lambda x: root.toggle_shuffle()]]
                        on_action_button: root.toggle_song_play()
                        mode: 'center'
